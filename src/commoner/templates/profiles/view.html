{% extends "base.html" %}
{% load license %}
{% load thumbnail %}

{% block header %}
<link rel="openid.server" href="{{base_url}}{% url commoner.server.views.endpoint %}" />
<link rel="openid2.provider" href="{{base_url}}{% url commoner.server.views.endpoint %}" />

<link about="" typeof="sioc:User" />
{% endblock %}

{% block head_title %}{{ profile.display_name }} -{% endblock %}

{% block page_header %}
  <span rel="sioc:member_of" resource="/">
    {{ profile.display_name }}
  </span>
{% endblock %}
{% block page_sub_header %}
  {% if profile.active %}
    Active 
  {% else %}
    Inactive
  {% endif %}
{% endblock %}

{% block extra_nav %}
{% if user.is_authenticated %}
  {% ifequal user.username profile_user.username %}
<li><a href="{% url profile_edit %}">Edit Profile</a></li>
  {% endifequal %}{% endif %}
{% endblock %}

{% block body %}
<div class="column-wide column profile-info">

  {% if profile %}
   {% if profile.photo %}
    <img src="{{ profile.photo|scale }}" 
         alt="[ {{ profile_user.first_name }}]" 
         />
   {% else %}
    <img src="/m/images/blank-avatar.jpg" alt="[ {{ profile_user.first_name }} ]" />
   {% endif %}

   <ul>
     <li property="sioc:name">{{ profile_user.first_name }} {{ profile_user.last_name}}</li>
     <li><a href="{{profile.homepage}}">{{ profile.homepage }}</a></li>
     <li>{{ profile.location }}</li>
   </ul>
  <div class="clear story">
    {% if profile.story %}
    <h2>My CC Story</h2>
    <a href="" rel="cc:attributionURL"></a>
    {{ profile.story|escape|linebreaks }}
    {% endif %}

  </div>

  {% else %}
  
  <p>
    <ul>
      <li property="cc:attributionName">{{ profile_user.first_name }} {{ profile_user.last_name}}</li>
    </ul>
  </p>

  {% endif %}

</div>

<div class="column-narrow column">
    {% if user.is_authenticated %}
      {% ifequal user.username profile_user.username %}
        <div id="badge">
          <img src="{{ profile.badge_img_url }}" alt="CC Network - Badge" title="CC Network" border="0" />
          <p>
            <strong>Place this badge on your website</strong><br/>
            <input id="network-badge" value='{% include "profiles/badge.html" %}' 
		   readonly="readonly" onclick="this.select()" onfocus="document.getElementById('network-badge').select();" type="text" />
          </p>
        </div>
      {% endifequal %}{% endif %}
	{% ifequal user.username profile_user.username %}
	<a style="float:right;" 
	   title="add a work" href="{% url add_content %}">+</a>
	{% endifequal %}
    <h4>Works I Have Licensed</h4>
    {% if profile_user.content.all %}
    <ul class="licensed-works">
      {% for work in profile_user.content.all|slice:":5" %}
      <li>
	<a rel="sioc:owner_of" href="{{work.url}}">
	   <strong property="dct:title">{{work.title}}</strong></a>
	   <br/>
	<a href="{{work.get_absolute_url}}">{{work.registered}}</a> &mdash;

        {% if work.license %}
	<a about="{{work.url}}" rel="license" href="{{work.license}}" >
	  <img src="{{work.license|license_button}}" 
	       alt="{{work.license|license_code}}" 
	       style="border:0;" /></a> 
        {% endif %}
	{% ifequal user work.user %}
	  <a href="{% url edit_content work.id %}">[edit]</a>
	  <a href="{% url delete_content work.id %}">[delete]</a>
	{% endifequal %}
      </li>
      {% endfor %}
<li style="text-align:right"><a rel="rdf:seeAlso" href="{% url commoner.profiles.views.works profile_user.username %}"><em>All...</em></a></li>
	</ul>
    {% else %}
      {% ifequal user.username username %}
        <span class="no-works">You haven't registered any licensed
	  works at this time; would you like to 
	  <a href="{% url add_content %}">add one</a>?</span>
      {% else %}
        <span class="no-works">This user has not registered any
	  licensed works.</span>
      {% endifequal %}
    {% endif %}
</div>

<br style="clear: both" />

{% endblock %}
