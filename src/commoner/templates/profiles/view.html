{% extends "base.html" %}
{% load license %}

{% block header %}
<link rel="openid.server" href="{{base_url}}{% url commoner.server.views.endpoint %}">
<link rel="openid2.provider" href="{{base_url}}{% url commoner.server.views.endpoint %}">
{% endblock %}


{% block page_header %}{{ profile.display_name }}{% endblock %}
{% block page_sub_header %}Active Commoner{% endblock %}

{% block extra_nav %}
{% if user.is_authenticated %}
  {% ifequal user profile.user %}
<li><a href="{% url profile_edit %}">edit</a></li>
  {% endifequal %}{% endif %}
{% endblock %}

{% block body %}
<div class="column-wide column profile-info">

  {% if profile %}
  <img src="{{ profile.photo.url }}" 
       width="150" height="150" 
       alt="[ {{ profile.user.first_name }}]" 
       />
  <p>
    <ul>
    <li>{{ profile.user.first_name }} {{ profile.user.last_name}}</li>
    <li>{{ profile.homepage }}</li>
    <li>{{ profile.location }}</li>
    </ul>
  </p>
  <p class="clear">
    <h2>My Story</h2>
    {{ profile.story }}
    
  </p>

  {% else %}
  
  <p>
    <ul>
      <li>{{ user.first_name }} {{ user.last_name}}</li>
    </ul>
  </p>

  {% endif %}

</div>

<div class="column-narrow column">
  <p>
    <h4>Works I Have Licensed</h4>
    {% if user.content.all %}
    <ul class="licensed-works">
      {% for work in user.content.all %}
      <li><a href="{{work.url}}">{{work.title}}</a> &mdash;
      {{work.registered}} &mdash;

	<a href="{{work.license}}">
	  <img src="{{work.license|license_button}}" 
	       alt="{{work.license|license_code}}" 
	       style="border:0;" /></a> 
	{% ifequal user work.user %}
	  <a href="{% url edit_content work.id %}">[edit]</a>
	  <a href="{% url delete_content work.id %}">[delete]</a>
	{% endifequal %}
      </li>
      {% endfor %}
    </ul>
    {% else %}
      {% ifequal user.username username %}
        <span class="no-works">You haven't registered any licensed
	  works at this time; would you like to 
	  <a href="{% url add_content %}">add one</a>?</span>
      {% else %}
        <span class="no-works">This user has not registered any
	  licensed works.</span>
      {% endifequal %}
    {% endif %}
  </p>
</div>

{% else %}

<div class="column-wide column profile-info">
This user hasn't created a profile yet.
</div>

{% endif %}
<br clear="both" />

  <!-- content block here -->

{% endblock %}
